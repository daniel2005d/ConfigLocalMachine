---
- name: "Checinkg sublimetext"
  stat:
    path: "/usr/bin/subl"
  register: subl_command

- name: "Configuring Subl Repos"
  shell: |
    wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/sublimehq-archive.gpg > /dev/null
    echo "deb https://download.sublimetext.com/ apt/stable/" | sudo tee /etc/apt/sources.list.d/sublime-text.list
  when: not subl_command.stat.exists

- name: "Change opt permissions"
  shell:
    cmd: chown -R {{ ansible_env.USER}}:{{ ansible_env.USER}} /opt
  become: true
  become_method: sudo

- name: "Install rofi, git, apt-transport-https, sublime-text"
  apt:
    name: xclip,sublime-text, build-essential,dkms,linux-headers-{{ansible_kernel}},rofi, git,apt-transport-https, vim, grc, tmux, python3-pip, libssl-dev, libffi-dev, python-dev-is-python3, python3-venv, ssh, jq
    state: present
    update_cache: true
  become: true
  become_method: sudo

- name: "Checinkg VsCode"
  stat:
    path: "/usr/bin/codium"
  register: code_command

- name: "Installing pip tools"
  pip:
    name: updog, pipx, impacket

- name: "Checking 24x24 theme folder"
  stat:
    path: "/usr/share/icons/hackthebox/24x24/apps"
  register: icons_24_folder

- name: "Creating 24 icons folder"
  file:
    path: "/usr/share/icons/hackthebox/24x24/apps"
    state: "directory"
    mode: 0755
  become: true
  become_method: sudo
  when: not icons_24_folder.stat.exists

- name: "Checinkg VsCode code aliases"
  stat:
    path: "/usr/bin/codium"
  register: codium_command

- name: "Checinkg VsCode code aliases 2"
  stat:
    path: "/usr/bin/code"
  register: code_command

- name: "Installing Visual Studio Code"
  apt:
    deb: "https://az764295.vo.msecnd.net/stable/4cb974a7aed77a74c7813bdccd99ee0d04901215/code_1.79.1-1686587647_amd64.deb"
  become: true
  become_method: sudo
  when: not code_command.stat.exists

- name: "Creating VsCode link"
  shell:
    cmd: ln -s /usr/bin/codium /usr/bin/code
  become: true
  become_method: sudo
  when: codium_command.stat.exists and not code_command.stat.exists
